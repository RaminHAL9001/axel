(module Axel.Haskell.Macros)

(import Axel.Prelude all)
(import Axel.Haskell.Language (isOperator))
(importq Data.Text T all)

(def hygenisizeMacroName (() {Text -> Text})
     ((oldName)
      (let ((suffix
             (if (isOperator (T.unpack oldName))
                 "%%%%%%%%%%"
                 "_AXEL_AUTOGENERATED_MACRO_DEFINITION")))
        (if {suffix T.isSuffixOf oldName} oldName {oldName <> suffix}))))
